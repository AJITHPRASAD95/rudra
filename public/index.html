<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rudrakalshethra - Bharatanatyam Dance School</title>
    <style>
        /* CSS styles remain the same as the file you uploaded */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #fff5f0 0%, #ffe6d9 100%);
            color: #333;
        }

        .header {
            background: linear-gradient(135deg, #d84315 0%, #f57c00 100%);
            color: white;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 28px;
            font-weight: bold;
        }

        .logo-icon {
            font-size: 40px;
        }

        .nav-menu {
            display: flex;
            gap: 30px;
            list-style: none;
        }

        .nav-menu li {
            cursor: pointer;
            padding: 10px 15px;
            border-radius: 8px;
            transition: background 0.3s;
        }

        .nav-menu li:hover, .nav-menu li.active {
            background: rgba(255,255,255,0.2);
        }

        .container {
            max-width: 1200px;
            margin: 30px auto;
            padding: 0 20px;
        }

        .hero-section {
            background: linear-gradient(135deg, #ff6f00 0%, #ff8f00 100%);
            color: white;
            padding: 50px;
            border-radius: 20px;
            margin-bottom: 40px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .hero-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .hero-text h1 {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .hero-text p {
            font-size: 20px;
            opacity: 0.9;
        }

        .hero-icon {
            font-size: 120px;
            opacity: 0.3;
        }

        .section-title {
            font-size: 32px;
            margin-bottom: 30px;
            color: #d84315;
            font-weight: bold;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
        }

        .card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
        }

        .card-image {
            width: 100%;
            height: 200px;
            background: #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 60px;
            color: #999;
        }

        .card-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .card-content {
            padding: 20px;
        }

        .card-category {
            display: inline-block;
            background: #ffccbc;
            color: #d84315;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .card-title {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }

        .card-description {
            color: #666;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .btn {
            background: linear-gradient(135deg, #d84315 0%, #f57c00 100%);
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: transform 0.2s;
            display: inline-block;
        }

        .btn:hover {
            transform: scale(1.05);
        }

        .quick-access {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .quick-access-card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .quick-access-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }

        .quick-access-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 15px;
            background: #ffccbc;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
        }

        .quick-access-title {
            font-size: 18px;
            font-weight: bold;
            color: #333;
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 30px;
            cursor: pointer;
            color: #999;
        }

        .modal-close:hover {
            color: #333;
        }

        .class-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .class-status {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .status-upcoming {
            background: #e3f2fd;
            color: #1976d2;
        }

        .status-ongoing {
            background: #e8f5e9;
            color: #388e3c;
        }

        .status-completed { /* Added status for completeness */
             background: #fbecec;
             color: #d32f2f;
        }


        .class-info {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: 15px 0;
        }

        .info-row {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #666;
        }

        .theory-list {
            list-style: none;
        }

        .theory-item {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .theory-item:hover {
            transform: translateX(10px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.15);
        }

        .theory-icon {
            width: 60px;
            height: 60px;
            background: #ffccbc;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
        }

        .theory-content {
            flex: 1;
        }

        .theory-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .theory-desc {
            color: #666;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #ff6f00;
        }

        .fab {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #d84315 0%, #f57c00 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 30px;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            transition: transform 0.3s;
        }

        .fab:hover {
            transform: scale(1.1);
        }

        @media (max-width: 768px) {
            .nav-menu {
                gap: 10px;
            }

            .hero-text h1 {
                font-size: 32px;
            }

            .hero-icon {
                display: none;
            }

            .grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <div class="logo">
                <span class="logo-icon">üé≠</span>
                <span>Rudrakalshethra</span>
            </div>
            <ul class="nav-menu">
                <li class="active" onclick="showPage('home')">Home</li>
                <li onclick="showPage('mudras')">Mudras</li>
                <li onclick="showPage('theory')">Theory</li>
                <li onclick="showPage('classes')">Classes</li>
            </ul>
        </div>
    </div>

    <div class="container">
        <div id="home" class="page active">
            <div class="hero-section">
                <div class="hero-content">
                    <div class="hero-text">
                        <h1>Welcome to Rudrakalshethra</h1>
                        <p>Master the ancient art of Bharatanatyam</p>
                    </div>
                    <div class="hero-icon">üïâÔ∏è</div>
                </div>
            </div>

            <h2 class="section-title">Quick Access</h2>
            <div class="quick-access">
                <div class="quick-access-card" onclick="showPage('mudras')">
                    <div class="quick-access-icon">ü§ö</div>
                    <div class="quick-access-title">Mudras</div>
                </div>
                <div class="quick-access-card" onclick="showPage('theory')">
                    <div class="quick-access-icon">üìñ</div>
                    <div class="quick-access-title">Theory</div>
                </div>
                <div class="quick-access-card" onclick="showPage('classes')">
                    <div class="quick-access-icon">üé•</div>
                    <div class="quick-access-title">Online Classes</div>
                </div>
                <div class="quick-access-card">
                    <div class="quick-access-icon">‚ñ∂Ô∏è</div>
                    <div class="quick-access-title">Practice</div>
                </div>
            </div>
        </div>

        <div id="mudras" class="page">
            <h2 class="section-title">Mudra Tutorials</h2>
            <div id="mudraGrid" class="grid"></div>
        </div>

        <div id="theory" class="page">
            <h2 class="section-title">Theory & Concepts</h2>
            <ul class="theory-list">
                <li class="theory-item" onclick="showTheoryDetail('Introduction to Bharatanatyam')">
                    <div class="theory-icon">üìú</div>
                    <div class="theory-content">
                        <div class="theory-title">Introduction to Bharatanatyam</div>
                        <div class="theory-desc">Learn about the origin and history of Bharatanatyam</div>
                    </div>
                    <span>‚Üí</span>
                </li>
                <li class="theory-item" onclick="showTheoryDetail('Asamyukta Hastas')">
                    <div class="theory-icon">ü§ö</div>
                    <div class="theory-content">
                        <div class="theory-title">Asamyukta Hastas</div>
                        <div class="theory-desc">Single hand gestures - 28 fundamental mudras</div>
                    </div>
                    <span>‚Üí</span>
                </li>
                <li class="theory-item" onclick="showTheoryDetail('Samyukta Hastas')">
                    <div class="theory-icon">üëê</div>
                    <div class="theory-content">
                        <div class="theory-title">Samyukta Hastas</div>
                        <div class="theory-desc">Double hand gestures - combined mudras</div>
                    </div>
                    <span>‚Üí</span>
                </li>
                <li class="theory-item" onclick="showTheoryDetail('Adavus')">
                    <div class="theory-icon">üë£</div>
                    <div class="theory-content">
                        <div class="theory-title">Adavus</div>
                        <div class="theory-desc">Basic steps and movements in Bharatanatyam</div>
                    </div>
                    <span>‚Üí</span>
                </li>
                <li class="theory-item" onclick="showTheoryDetail('Nritta, Nritya, Natya')">
                    <div class="theory-icon">üé≠</div>
                    <div class="theory-content">
                        <div class="theory-title">Nritta, Nritya, Natya</div>
                        <div class="theory-desc">Three aspects of classical dance</div>
                    </div>
                    <span>‚Üí</span>
                </li>
            </ul>
        </div>

        <div id="classes" class="page">
            <h2 class="section-title">Online Classes</h2>
            <div id="classesContainer"></div>
        </div>
    </div>

    <div id="mudraModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal('mudraModal')">&times;</span>
            <div id="mudraDetail"></div>
        </div>
    </div>

    <div id="theoryModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal('theoryModal')">&times;</span>
            <div id="theoryDetail"></div>
        </div>
    </div>

    <div id="addMudraModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal('addMudraModal')">&times;</span>
            <h2 style="margin-bottom: 25px;">Add New Mudra</h2>
            <form id="addMudraForm">
                <div class="form-group">
                    <label>Mudra Name</label>
                    <input type="text" id="mudraName" required>
                </div>
                <div class="form-group">
                    <label>Category</label>
                    <select id="mudraCategory" required>
                        <option value="">Select Category</option>
                        <option value="Asamyukta Hasta">Asamyukta Hasta</option>
                        <option value="Samyukta Hasta">Samyukta Hasta</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea id="mudraDescription" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label>Usage (Meaning/Theory)</label>
                    <textarea id="mudraUsage" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label>Image URL</label>
                    <input type="url" id="mudraImageUrl" required>
                </div>
                <button type="submit" class="btn" style="width: 100%;">Save Mudra</button>
            </form>
        </div>
    </div>

    <div class="fab" onclick="openModal('addMudraModal')" title="Add New Mudra">+</div>

    <script>
        // FIX: Corrected API URL to match the server's port (5000)
        const API_URL = 'http://localhost:5000/api'; 

        // Sample data (fallback if API not available)
        const sampleMudras = [
            {
                _id: '1',
                name: 'Pataka',
                category: 'Asamyukta Hasta',
                description: 'The palm is held flat with all fingers together and the thumb bent.',
                image: 'https://via.placeholder.com/300x200?text=Pataka+Mudra',
                meaning: 'Used to denote cloud, night, river, horse, cutting, wind, etc.'
            },
            {
                _id: '2',
                name: 'Tripataka',
                category: 'Asamyukta Hasta',
                description: 'Ring finger is bent while other fingers are extended.',
                image: 'https://via.placeholder.com/300x200?text=Tripataka+Mudra',
                meaning: 'Used to denote crown, tree, flame, lamp, etc.'
            }
        ];

        const sampleClasses = [
            {
                _id: '1',
                title: 'Beginner Batch - Morning',
                schedule: 'Mon, Wed, Fri - 7:00 AM',
                duration: '1 hour',
                instructor: 'Guru Priya',
                meetLink: 'https://meet.google.com/xxx-xxxx-xxx',
                status: 'upcoming'
            },
            {
                _id: '2',
                title: 'Intermediate Level - Evening',
                schedule: 'Tue, Thu, Sat - 6:00 PM',
                duration: '1.5 hours',
                instructor: 'Guru Lakshmi',
                meetLink: 'https://meet.google.com/yyy-yyyy-yyy',
                status: 'ongoing'
            }
        ];

        // Page navigation
        function showPage(pageName) {
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
            document.querySelectorAll('.nav-menu li').forEach(item => item.classList.remove('active'));
            
            document.getElementById(pageName).classList.add('active');
            // Use currentTarget to ensure the 'li' element gets the active class
            if(event && event.currentTarget) {
                event.currentTarget.classList.add('active');
            } else {
                 document.querySelector(`.nav-menu li[onclick*="${pageName}"]`).classList.add('active');
            }


            if (pageName === 'mudras') loadMudras();
            if (pageName === 'classes') loadClasses();
        }

        // Load mudras
        async function loadMudras() {
            try {
                const response = await fetch(`${API_URL}/mudras`);
                // Use .ok to check HTTP status, fall back to sample data on failure
                const mudras = response.ok ? await response.json() : sampleMudras;
                displayMudras(mudras);
            } catch (error) {
                console.error('API connection failed, showing sample data:', error);
                displayMudras(sampleMudras);
            }
        }

        function displayMudras(mudras) {
            const grid = document.getElementById('mudraGrid');
            grid.innerHTML = mudras.map(mudra => `
                <div class="card" onclick="showMudraDetail('${mudra._id}')">
                    <div class="card-image">
                        <img src="${mudra.image}" alt="${mudra.name}" onerror="this.parentElement.innerHTML='ü§ö'">
                    </div>
                    <div class="card-content">
                        <span class="card-category">${mudra.category}</span>
                        <div class="card-title">${mudra.name}</div>
                        <div class="card-description">${mudra.description}</div>
                    </div>
                </div>
            `).join('');
        }

        // Show mudra detail
        async function showMudraDetail(id) {
            let mudra;
            try {
                const response = await fetch(`${API_URL}/mudras/${id}`);
                mudra = response.ok ? await response.json() : sampleMudras.find(m => m._id === id);
                
                document.getElementById('mudraDetail').innerHTML = `
                    <img src="${mudra.image}" style="width: 100%; border-radius: 12px; margin-bottom: 20px;" onerror="this.style.display='none'">
                    <h2 style="margin-bottom: 15px;">${mudra.name}</h2>
                    <span class="card-category">${mudra.category}</span>
                    <h3 style="margin-top: 20px; margin-bottom: 10px;">Description</h3>
                    <p style="line-height: 1.6; color: #666;">${mudra.description}</p>
                    <h3 style="margin-top: 20px; margin-bottom: 10px;">Usage/Meaning</h3>
                    <p style="line-height: 1.6; color: #666;">${mudra.meaning}</p>
                    <button class="btn" style="margin-top: 25px; width: 100%;">‚ñ∂Ô∏è Watch Tutorial Video</button>
                `;
                openModal('mudraModal');
            } catch (error) {
                console.error('Error loading mudra:', error);
            }
        }

        // Load classes
        async function loadClasses() {
            try {
                // The backend doesn't have a /api/classes route, so we use sample data for now.
                // If you add a /api/classes route, uncomment the API fetch below.
                /*
                const response = await fetch(`${API_URL}/classes`);
                const classes = response.ok ? await response.json() : sampleClasses;
                displayClasses(classes);
                */
                displayClasses(sampleClasses);

            } catch (error) {
                displayClasses(sampleClasses);
            }
        }

        function displayClasses(classes) {
            const container = document.getElementById('classesContainer');
            container.innerHTML = classes.map(cls => `
                <div class="class-card">
                    <span class="class-status status-${cls.status}">${cls.status.toUpperCase()}</span>
                    <div class="card-title">${cls.title}</div>
                    <div class="class-info">
                        <div class="info-row">‚è∞ ${cls.schedule}</div>
                        <div class="info-row">‚è±Ô∏è ${cls.duration}</div>
                        <div class="info-row">üë§ ${cls.instructor}</div>
                    </div>
                    <button class="btn" style="width: 100%;" onclick="window.open('${cls.meetLink}', '_blank')">üé• Join Class</button>
                </div>
            `).join('');
        }

        // Theory detail (Currently static content)
        function showTheoryDetail(title) {
            document.getElementById('theoryDetail').innerHTML = `
                <h2 style="margin-bottom: 20px;">${title}</h2>
                <p style="line-height: 1.8; color: #666;">
                    This is where detailed theory content for "${title}" will be displayed.
                </p>
                <div style="background: #fff3e0; padding: 15px; border-radius: 10px; margin-top: 20px; border-left: 4px solid #ff6f00;">
                    <strong>Note:</strong> You can add an API route like /api/theory/:title to dynamically fetch content from your MongoDB.
                </div>
            `;
            openModal('theoryModal');
        }

        // Modal functions
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // Add mudra form submission
        document.getElementById('addMudraForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const mudraData = {
                name: document.getElementById('mudraName').value,
                category: document.getElementById('mudraCategory').value,
                description: document.getElementById('mudraDescription').value,
                // FIX: map 'usage' from frontend form to 'meaning' for the backend schema
                meaning: document.getElementById('mudraUsage').value, 
                // FIX: map 'imageUrl' from frontend form to 'image' for the backend schema
                image: document.getElementById('mudraImageUrl').value 
            };

            try {
                const response = await fetch(`${API_URL}/mudras`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(mudraData)
                });

                if (response.ok) {
                    alert('Mudra added successfully!');
                    closeModal('addMudraModal');
                    loadMudras();
                    document.getElementById('addMudraForm').reset();
                } else {
                    const error = await response.json();
                    alert(`Error adding mudra: ${error.error || response.statusText}. Check server console.`);
                }
            } catch (error) {
                alert('Could not connect to server at http://localhost:5000/api. Ensure your Node server is running.');
            }
        });

        // Initial load
        loadMudras();
    </script>
</body>
</html>